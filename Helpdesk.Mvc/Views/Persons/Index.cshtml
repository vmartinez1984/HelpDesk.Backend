@{
    ViewBag.Title = "Personas";
}

<div class="container">
   
    <div class="card mt-5">
        <div class="card-header">
            <h2>Lista de personas</h2>
        </div>
        <div class="card-body">
            <p>                
                <a asp-action="Create">
                    <i class="align-middle" data-feather="plus-circle"></i> 
                    <span class="align-middle">Agregar nuevo</span> 
                </a>
            </p>

            <table class="table" id="table">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Apellidos</th>
                        <th>Agencia</th>
                        <th>Fecha</th>    
                        <th></th>                    
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <div class="card-footer"></div>
    </div>
</div>

@section Scripts{
    <!-- ============================================================
    =ESTILOS PARA USO DE DATATABLES JS
    ===============================================================-->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.0/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.9/css/responsive.dataTables.min.css">

    <!-- ============================================================
    =LIBRERIAS PARA USO DE DATATABLES JS
    ===============================================================-->
    <script src="https://cdn.datatables.net/1.11.0/js/jquery.dataTables.min.js"></script>        
    <script src="https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js"></script>

    <script>
        $(document).ready(function(){        
            $("#table").DataTable({
                "processing":true,
                "serverSide": true,
                "ajax":{
                    "url": "https://localhost:11028/Api/Persons",
                    "type":"GET",
                    "datatype":"json"
                },
                "pageLength": 10,                
                "columns":[
                    {"data":"name", "name":"Nombre"}
                    , {"data":"lastName", "name":"Apellidos"} 
                    , {"data":"agencyName", "name":"Agency"} 
                    , { "data" : "dateRegistration"
                        , "name" : "Fecha"
                        , "mRender" : function (data, type, row) {
                            return data.substring(0,10) //Date.Parse(data).toString().format('DD/MM/YYYY');
                        }               
                    }
                    , { "data" : null,
                        "bSortable" : false,
                        "mRender" : function (data, type,value){
                            return '<a href="/Persons/Details/' + value['id'] + '" class="btn btn-info text-white">'
                            + '     <i class="align-middle" data-feather="clipboard"></i>'
                            + '     <span class="align-middle">Detalles</span>'
                            + '</a>'
                            + ' <a href="/Persons/Edit/' + value['id'] + '" class="btn btn-warning text-white">'
                            + '     <i class="align-middle" data-feather="edit"></i> '
                            + '     <span class="align-middle">Editar</span>'
                            + ' </a>'
                            + ' <a href="/Persons/Delete/' + value['id'] + '" class="btn btn-danger">'
                            + '     <i class="align-middle" data-feather="delete"></i> '
                            + '     <span class="align-middle">Borrar</span>'
                            + ' </a>'
                        }
                        , "autoWidth":true
                    }
                ],
                lengthChange: true,
                "language": {
                    "lengthMenu": "Mostrando _MENU_ registros por página",
                    "zeroRecords": "Registro(s) no encontrado(s)",
                    "info": "Página _PAGE_ de _PAGES_, _TOTAL_ elementos",
                    "infoEmpty": "Registros no disponibles",
                    "infoFiltered": "(de _MAX_ elementos en total)",
                    "search": "Buscar",
                    paginate: {
                        previous: '‹',
                        next: '›'
                    },
                    aria: {
                        paginate: {
                            previous: 'Anterior',
                            next: 'Siguiente'
                        }
                    }
                }
            })
        })
    </script>
}